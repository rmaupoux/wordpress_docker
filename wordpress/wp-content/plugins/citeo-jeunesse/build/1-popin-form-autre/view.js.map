{"version":3,"file":"1-popin-form-autre/view.js","mappings":"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","sources":["webpack://citeo-jeunesse/./src/1-popin-form-autre/view.js"],"sourcesContent":["document.addEventListener(\"DOMContentLoaded\", () => {\n    // Sélection des éléments HTML\n    const telechargerDiv = document.querySelector('.popin-jeunesse--telecharger');\n    const selectJeunesse = document.getElementById('selectJeunesseAutre');\n    const numberEnfantAutre = document.getElementById('numberEnfantAutre');\n    const closeButtonAutre = document.getElementById('closePopinButtonAutre');\n    const overlayAutre = document.getElementById('popinOverlayAutre');\n    const receiveNewsCheckbox = document.getElementById('receiveNewsAutre');\n    const checkboxes = [receiveNewsCheckbox, document.getElementById('refuseSurveysAutre')];\n    const blockEmail = document.querySelector(\"#form-jeunesse-autre .show-email\");\n    const emailInput = document.getElementById('emailAutre');\n    const cookieJeunesse = 'enregistrement_jeunesse';\n\n    // Vérifie si un cookie est présent\n    function checkCookie(cookieName) {\n        return document.cookie.split(';').some(cookie => cookie.trim().startsWith(`${cookieName}=`));\n    }\n\n    // Téléchargement du fichier\n    function triggerDownload(url) {\n        const link = document.createElement('a');\n        link.href = url;\n        link.download = '';\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n    }\n\n    // Mise à jour de l'affichage du bouton de téléchargement\n    function updateTelechargerVisibility() {\n        const selectValue = selectJeunesse.value;\n        const numberValue = numberEnfantAutre.value.trim();\n        const isNumberEnfantValidAutre = numberValue !== \"\" && !isNaN(numberValue) && Number(numberValue) >= 0;\n        const isReceiveNewsChecked = receiveNewsCheckbox.checked;\n        const isEmailValid = emailInput && emailInput.value.match(/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/);\n\n\n        if (\n            selectValue !== '' &&\n            selectValue !== '...' &&\n            isNumberEnfantValidAutre &&\n            (!isReceiveNewsChecked || (isReceiveNewsChecked && isEmailValid))\n        ) {\n            telechargerDiv.classList.add('show-telecharge');\n        } else {\n            telechargerDiv.classList.remove('show-telecharge');\n        }\n    }\n\n    // Gère le clic sur les boutons de téléchargement de fichiers PDF\n    const pdfRegex = /\\.pdf(\\?.*|#.*|$)/i;\n    const openButtonsAutre = [\n        ...document.querySelectorAll('.has-prefix--Download a')\n    ].filter(link => pdfRegex.test(link.href));\n\n    // Ajout de l'attribut aria-haspopup=\"dialog\" et aria-expanded=\"false\" sur tous les openButtonsAutre\n    openButtonsAutre.forEach((button) => {\n        button.setAttribute('aria-haspopup', 'dialog');\n        button.setAttribute('aria-expanded', 'false');\n    });\n\n    openButtonsAutre.forEach(button => {\n        // Désactive le clic droit (menu contextuel)\n        button.addEventListener('contextmenu', function (event) {\n            event.preventDefault();\n        });\n        button.addEventListener('mousedown', function(event) {\n                if (event.button === 1) event.preventDefault();\n            });\n        button.addEventListener('mouseup', function(event) {\n                if (event.button === 1) event.preventDefault();\n            });\n\n        // Désactive Ctrl+clic ou Cmd+clic (ouverture dans un nouvel onglet)\n        button.addEventListener('click', function (event) {\n            if (event.ctrlKey || event.metaKey || event.button === 1) {\n                event.preventDefault();\n                return;\n            }\n            event.preventDefault();\n            const downloadUrl = button.getAttribute('href');\n\n            if (checkCookie(cookieJeunesse)) {\n                if (downloadUrl) {\n                    triggerDownload(downloadUrl);\n                }\n            } else {\n                button.setAttribute('aria-expanded', 'true');\n                const form = document.getElementById('form-jeunesse-autre');\n\n                let hiddenInput = form.querySelector('input[name=\"typeDownload\"]');\n                if (!hiddenInput) {\n                    hiddenInput = document.createElement('input');\n                    hiddenInput.type = 'hidden';\n                    hiddenInput.name = 'typeDownload';\n                    form.appendChild(hiddenInput);\n                }\n                hiddenInput.value = downloadUrl;\n                overlayAutre.style.display = 'flex';\n            }\n        });\n    });\n\n    // Fermeture de la popin au clic sur le bouton \"fermer\"\n    closeButtonAutre.addEventListener('click', () => {\n        openButtonsAutre.forEach((button) => {\n            button.setAttribute('aria-expanded', 'false');\n        });\n        overlayAutre.style.display = 'none';\n    });\n\n    // Fermeture de la popin au clic en dehors de la boîte\n    overlayAutre.addEventListener('click', event => {\n        if (event.target === overlayAutre) {\n            openButtonsAutre.forEach((button) => {\n                button.setAttribute('aria-expanded', 'false');\n            });\n            overlayAutre.style.display = 'none';\n        }\n    });\n\n    // Écoute des changements pour mettre à jour la visibilité du bouton de téléchargement\n    selectJeunesse.addEventListener('change', updateTelechargerVisibility);\n    numberEnfantAutre.addEventListener('input', updateTelechargerVisibility);\n    receiveNewsCheckbox.addEventListener('change', updateTelechargerVisibility);\n    emailInput.addEventListener('input', updateTelechargerVisibility);\n\n    // Affichage du champ email si la case newsletter ou refuse Survey est cochée // TODO : Supprimez car email tout le temps visible dans la nouvelle maquette\n    function updateEmailVisibility() {\n        // some() check dans l'array checkboxes si un element est checked si oui alors affiche le block email\n        const shouldDisplay = checkboxes.some(cb => cb.checked);\n        blockEmail.style.display = shouldDisplay ? \"block\" : \"none\";\n    }\n\n    // Initialisation\n    checkboxes.forEach(cb => cb?.addEventListener(\"change\", updateEmailVisibility));\n    updateEmailVisibility();\n});\n"],"names":["document","addEventListener","telechargerDiv","querySelector","selectJeunesse","getElementById","numberEnfantAutre","closeButtonAutre","overlayAutre","receiveNewsCheckbox","checkboxes","blockEmail","emailInput","cookieJeunesse","checkCookie","cookieName","cookie","split","some","trim","startsWith","triggerDownload","url","link","createElement","href","download","body","appendChild","click","removeChild","updateTelechargerVisibility","selectValue","value","numberValue","isNumberEnfantValidAutre","isNaN","Number","isReceiveNewsChecked","checked","isEmailValid","match","classList","add","remove","pdfRegex","openButtonsAutre","querySelectorAll","filter","test","forEach","button","setAttribute","event","preventDefault","ctrlKey","metaKey","downloadUrl","getAttribute","form","hiddenInput","type","name","style","display","target","updateEmailVisibility","shouldDisplay","cb"],"sourceRoot":""}