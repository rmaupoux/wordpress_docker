{"version":3,"file":"2-popin-form-video/view.js","mappings":"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","sources":["webpack://citeo-jeunesse/./src/2-popin-form-video/view.js"],"sourcesContent":["document.addEventListener('DOMContentLoaded', () => {\n\n    const telechargeVideoDiv = document.querySelector('.popin-jeunesse--telecharge-video');\n    const selectJeunesseVideo = document.getElementById('selectJeunesseVideo');\n    const numberEnfantVideo = document.getElementById('numberEnfantVideo');\n    const closeButton = document.getElementById('closePopinButtonVideo');\n    const overlay = document.getElementById('popinOverlay');\n    const cookieJeunesse = 'enregistrement_jeunesse';\n    const receiveActuCheckbox = document.getElementById('receive_actu');\n    const receiveNewsCheckbox = document.getElementById('receiveNewsVideo');\n    const checkboxes = [receiveNewsCheckbox, document.getElementById('refuseSurveysAutre')];\n    const blockEmail = document.querySelector(\"#form-jeunesse-autre .show-email\");\n    const emailInput = document.getElementById('emailVideo');\n\n\n    function checkCookie(cookieName) {\n        const cookies = document.cookie;\n        return cookies.split(';').some(cookie => cookie.trim().startsWith(cookieName + '='));\n    }\n\n    const updateTelechargeVideoVisibility = () => {\n        const isOptionSelected = selectJeunesseVideo.value !== '' && selectJeunesseVideo.value !== '...';\n        const isNumberEnfantValid = numberEnfantVideo.value > 0;\n        const isReceiveActuChecked = receiveActuCheckbox.checked;\n        const isReceiveNewsChecked = receiveNewsCheckbox.checked;\n        const isEmailValid = emailInput && emailInput.value.match(/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/);\n\n        if (isOptionSelected && !isReceiveActuChecked) {\n            telechargeVideoDiv.classList.add('show-telecharge');\n        } else {\n            telechargeVideoDiv.classList.remove('show-telecharge');\n        }\n\n        if (isNumberEnfantValid && isOptionSelected) {\n            telechargeVideoDiv.classList.add('show-telecharge');\n        }\n\n        if (isReceiveNewsChecked && !isEmailValid) {\n            telechargeVideoDiv.classList.remove('show-telecharge');\n        }\n    };\n\n    const youtubeRegex = /^(https?:\\/\\/)?(www\\.)?(youtube\\.com|youtu\\.be)\\/(watch\\?v=|embed\\/|shorts\\/)?([a-zA-Z0-9_-]{11})/;\n    const mp4Regex = /\\.mp4$/;\n    const openButtons = [\n        ...document.querySelectorAll('.has-prefix--Download a')\n    ].filter(link => youtubeRegex.test(link.href) || mp4Regex.test(link.href));\n\n    // Ajout de l'attribut aria-haspopup=\"dialog\" sur tous les openButtons et améliorer l'accessibilité\n    openButtons.forEach((button) => {\n        button.setAttribute('aria-haspopup', 'dialog');\n        button.setAttribute('aria-expanded', 'false');\n    });\n\n    // Ajout de la condition globale pour checkCookie\n    if (!checkCookie(cookieJeunesse)) {\n        openButtons.forEach((button) => {\n            button.addEventListener('contextmenu', function (event) {\n                event.preventDefault();\n            });\n            button.addEventListener('mousedown', function(event) {\n                if (event.button === 1) event.preventDefault();\n            });\n            button.addEventListener('mouseup', function(event) {\n                if (event.button === 1) event.preventDefault();\n            });\n            \n\n            button.addEventListener('click', function (event) {\n                if (event.ctrlKey || event.metaKey || event.button === 1) {\n                    event.preventDefault();\n                    return;\n                }\n                event.preventDefault();\n                const url = button.getAttribute('href');\n                const isYoutube = youtubeRegex.test(url);\n                const isMp4 = mp4Regex.test(url);\n\n                const btnTelecharge = document.querySelector('.btn-with-svg.btn-with-svg--video');\n                if (btnTelecharge && btnTelecharge.dataset.initialText) {\n                    btnTelecharge.innerHTML = btnTelecharge.dataset.initialText;\n                }\n\n                if (isYoutube || isMp4) {\n                    if (isMp4 && btnTelecharge) {\n                        if (!btnTelecharge.dataset.initialText) {\n                            btnTelecharge.dataset.initialText = btnTelecharge.innerHTML;\n                        }\n                        btnTelecharge.innerHTML = \"Télécharger la video\";\n                    }\n                    const form = document.getElementById('form-jeunesse-video');\n                    let hiddenInput = form.querySelector('input[name=\"typeVideo\"]');\n                    if (!hiddenInput) {\n                        hiddenInput = document.createElement('input');\n                        hiddenInput.type = 'hidden';\n                        hiddenInput.name = 'typeVideo';\n                        form.appendChild(hiddenInput);\n                    }\n                    hiddenInput.value = url;\n                    button.setAttribute('aria-expanded', 'true');\n                    overlay.style.display = 'flex';\n                }\n            });\n        });\n\n        closeButton.addEventListener('click', () => {\n            const btnTelecharge = document.querySelector('.btn-with-svg.btn-with-svg--video');\n            if (btnTelecharge && btnTelecharge.dataset.initialText) {\n                btnTelecharge.innerHTML = btnTelecharge.dataset.initialText;\n            }\n            openButtons.forEach((button) => {\n                button.setAttribute('aria-expanded', 'false');\n            });\n            overlay.style.display = 'none';\n        });\n\n        overlay.addEventListener('click', (event) => {\n            if (event.target === overlay) {\n                openButtons.forEach((button) => {\n                    button.setAttribute('aria-expanded', 'false');\n                });\n                overlay.style.display = 'none';\n            }\n        });\n    } else {\n        // Si le cookie est présent, aucun comportement JS personnalisé n'est appliqué sur les boutons\n        // Les liens fonctionnent normalement (comportement natif)\n    }\n\n    const checkVideoBlock = document.getElementById('check-video');\n    if (checkVideoBlock) {\n        const checkbox = checkVideoBlock.querySelector('.check-video--checkbox');\n        const textDiv = checkVideoBlock.querySelector('.check-video--text');\n        const inputDiv = checkVideoBlock.querySelector('.check-video--input');\n\n        checkbox.addEventListener('change', () => {\n            if (checkbox.checked) {\n                textDiv.style.display = 'none';\n                inputDiv.style.display = 'flex';\n            } else {\n                textDiv.style.display = 'block';\n                inputDiv.style.display = 'none';\n            }\n        });\n    }\n\n    selectJeunesseVideo.addEventListener('change', updateTelechargeVideoVisibility);\n    numberEnfantVideo.addEventListener('change', updateTelechargeVideoVisibility);\n    receiveNewsCheckbox.addEventListener('change', updateTelechargeVideoVisibility);\n    receiveActuCheckbox.addEventListener('change', updateTelechargeVideoVisibility);\n    emailInput.addEventListener('input', function () {\n        updateTelechargeVideoVisibility();\n    });\n\n    // Affichage du champ email si la case newsletter ou refuse Survey est cochée // TODO : Supprimez car email tout le temps visible dans la nouvelle maquette\n    function updateEmailVisibility() {\n        // some() check dans l'array checkboxes si un element est checked si oui alors affiche le block email\n        const shouldDisplay = checkboxes.some(cb => cb.checked);\n        blockEmail.style.display = shouldDisplay ? \"block\" : \"none\";\n    }\n\n    // Initialisation\n    checkboxes.forEach(cb => cb?.addEventListener(\"change\", updateEmailVisibility));\n    updateEmailVisibility();\n\n});\n"],"names":["document","addEventListener","telechargeVideoDiv","querySelector","selectJeunesseVideo","getElementById","numberEnfantVideo","closeButton","overlay","cookieJeunesse","receiveActuCheckbox","receiveNewsCheckbox","checkboxes","blockEmail","emailInput","checkCookie","cookieName","cookies","cookie","split","some","trim","startsWith","updateTelechargeVideoVisibility","isOptionSelected","value","isNumberEnfantValid","isReceiveActuChecked","checked","isReceiveNewsChecked","isEmailValid","match","classList","add","remove","youtubeRegex","mp4Regex","openButtons","querySelectorAll","filter","link","test","href","forEach","button","setAttribute","event","preventDefault","ctrlKey","metaKey","url","getAttribute","isYoutube","isMp4","btnTelecharge","dataset","initialText","innerHTML","form","hiddenInput","createElement","type","name","appendChild","style","display","target","checkVideoBlock","checkbox","textDiv","inputDiv","updateEmailVisibility","shouldDisplay","cb"],"sourceRoot":""}